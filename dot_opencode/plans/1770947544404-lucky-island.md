# Fix bell.ts Plugin - Subagent Sound Issue

## Problem
The bell.ts plugin plays sounds for all agents instead of just primary agents. This broke when the SDK was upgraded to v2.

## Root Cause
The SDK v2 changed the return format of API calls:
- **Before**: `client.session.get(id)` returned session object directly
- **After**: `client.session.get(id)` returns `{ data: SessionInfo, error: ... }`

The bell.ts plugin accesses `session.parentID` on the wrapper object (where it doesn't exist â†’ `undefined`), so `!undefined` is `true`, incorrectly identifying ALL sessions as primary.

## Fix
Update `/Users/katherinemasseau/.config/opencode/supplemental/plugin/bell.ts` to destructure the `data` property:

**Line 48** - Change from:
```typescript
const session = await client.session.get(sessionID);
```

To:
```typescript
const { data: session } = await client.session.get(sessionID);
```

This fix applies to both uses:
1. Line 48: `isPrimaryAgentSession` function
2. Line 336: `permission.updated` event handler (calls the same function)

## Verification
Run OpenCode with `OPENCODE_DEBUG_BELL=true` environment variable to see debug output confirming:
- Session `parentID` values are now correctly detected
- Sounds only play for primary agents
